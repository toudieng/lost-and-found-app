{% extends "frontend/base.html" %}
{% load static %}

{% block title %}Dashboard Policier{% endblock %}

{% block content %}
<div class="row">
    
    <div class="col-md-3 col-lg-2 bg-dark text-white p-3 vh-100">
        <h4 class="mb-4">Policier</h4>
        <ul class="nav flex-column">
            <li><a class="nav-link text-white" href="{% url 'objets_reclames' %}">üìã Objets r√©clam√©s</a></li>
            <li><a class="nav-link text-white" href="{% url 'historique_restitutions' %}">üìÇ Historique des restitutions</a></li>
            <li><a class="nav-link text-white" href="{% url 'planifier_restitution' %}">üìç Planifier une restitution</a></li>
        </ul>
    </div>

    <div class="col-md-9 col-lg-10 p-4">
        <h2>Bienvenue sur votre espace Policier</h2>
        <p>Vous pouvez g√©rer les objets, voir les objets r√©clam√©s et programmer les restitutions depuis ce tableau de bord.</p>

        <hr>

        <h4 class="mb-3">üü¢ Objets r√©clam√©s</h4>
        {% if objets_reclames %}
            <div class="row">
                {% for declaration in objets_reclames %}
                    <div class="col-md-6 mb-4">
                        <div class="card shadow-sm h-100 border-0">
                            {% if declaration.image %}
                                <img src="{{ declaration.image.url }}" class="card-img-top" style="height:180px; object-fit:cover;" alt="Image de {{ declaration.objet.nom }}">
                            {% else %}
                                <img src="{% static 'img/default_objet.png' %}" class="card-img-top" style="height:180px; object-fit:cover;" alt="Image par d√©faut">
                            {% endif %}
                            <div class="card-body">
                                <h5 class="card-title fw-bold">{{ declaration.objet.nom }}</h5>
                                <p class="card-text small text-muted">{{ declaration.description|truncatewords:20 }}</p>
                                <p class="small mb-1"><strong>R√©clam√© par :</strong> 
                                    {% if declaration.reclame_par %}
                                        {{ declaration.reclame_par.username }}
                                    {% else %}
                                        N/A
                                    {% endif %}
                                </p>
                                <p class="small"><strong>D√©clar√© par :</strong> 
                                    {% if declaration.citoyen %}
                                        {{ declaration.citoyen.username }}
                                    {% else %}
                                        N/A
                                    {% endif %}
                                </p>
                            </div>
                            <div class="card-footer text-end bg-light">
                                <a href="{% url 'programmer_restitution' declaration.id %}" class="btn btn-sm btn-primary">üìç Programmer restitution</a>
                            </div>
                        </div>
                    </div>
                {% endfor %}
            </div>
        {% else %}
            <div class="alert alert-info text-center">Aucun objet r√©clam√© pour l'instant.</div>
        {% endif %}
    </div>
</div>
{% endblock %}
