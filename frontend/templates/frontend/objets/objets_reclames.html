{% extends 'frontend/policier/base_policier.html' %}

{% block title %}Objets rÃ©clamÃ©s{% endblock %}

{% block content %}
<div class="container mt-4">
    <h2 class="fw-bold mb-3">ðŸ“Œ Objets rÃ©clamÃ©s</h2>

    {% for dec in declarations %}
<div class="card my-3 shadow-sm border-0">
    <div class="card-body">
        <h5 class="card-title">{{ dec.objet.nom }}</h5>

        <p class="mb-1">
            <b>RÃ©clamÃ© par :</b>
            <span class="badge bg-primary me-2">
                ðŸ‘¤ {{ dec.reclame_par.username }}
            </span>
            <small class="text-muted me-3">
                ({{ dec.reclame_par.email|default:"N/A" }}, {{ dec.reclame_par.telephone|default:"N/A" }})
            </small>

            {% with restitution=restitutions_dict|get_item:(dec.objet.id, dec.reclame_par.id) %}
                {% if restitution %}
                    <button class="btn btn-secondary btn-sm" disabled>ðŸ“… Restitution planifiÃ©e</button>
                {% else %}
                    <a href="{% url 'planifier_restitution' dec.id dec.reclame_par.id %}" class="btn btn-primary btn-sm">
                        ðŸ“… Programmer restitution
                    </a>
                {% endif %}
            {% endwith %}
        </p>

        <p class="mb-1">
            <b>TrouvÃ© par :</b>
            {% for user in dec.trouve_par.all %}
                <span class="badge bg-success me-1 mb-1">ðŸ‘¤ {{ user.username }}</span>
            {% empty %}
                <span class="text-muted">N/A</span>
            {% endfor %}
        </p>

        <p class="mb-2">
            <b>Date dÃ©claration :</b> {{ dec.date_declaration|date:"d/m/Y H:i" }}
        </p>
    </div>
</div>
{% endfor %}

</div>
{% endblock %}
