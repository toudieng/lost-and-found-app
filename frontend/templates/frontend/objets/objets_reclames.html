{% extends 'frontend/policier/base_policier.html' %}
{% block title %}Objets Ã  restituer{% endblock %}

{% block content %}
<div class="container mt-4">
    <h2 class="fw-bold mb-3">ðŸ“Œ Objets Ã  restituer</h2>

    {% for declaration in declarations %}
        {% if declaration.objet.etat == "reclamÃ©" %}
            <div class="card my-2 p-3 shadow-sm">
                <h5>{{ declaration.objet.nom }}</h5>

                <p>
                    <b>RÃ©clamÃ© par :</b>
                    {% if declaration.reclame_par %}
                        {{ declaration.reclame_par.username }}
                    {% else %}
                        N/A
                    {% endif %}
                </p>

                <p>
                    <b>Lieu :</b> {{ declaration.lieu|default:"Non prÃ©cisÃ©" }}
                </p>

                <p>
                    <b>TrouvÃ© par :</b>
                    {% if declaration.trouve_par.exists %}
                        {% for user in declaration.trouve_par.all %}
                            {{ user.username }}{% if not forloop.last %}, {% endif %}
                        {% endfor %}
                    {% else %}
                        N/A
                    {% endif %}
                </p>

                {% if declaration.objet.id in restitutions_dict %}
                    <button class="btn btn-secondary btn-sm" disabled>ðŸ“… PlanifiÃ©</button>
                {% else %}
                    <a href="{% url 'planifier_restitution' declaration.id 'declaration' %}" 
                       class="btn btn-primary btn-sm">
                        ðŸ“… Programmer restitution
                    </a>
                {% endif %}
            </div>
        {% endif %}
    {% empty %}
        <div class="alert alert-info">Aucun objet rÃ©clamÃ© pour le moment.</div>
    {% endfor %}
</div>
{% endblock %}
